<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>GTX 1070 | CS Blog</title><link rel="stylesheet" type="text/css" href="/css/normalize.css"><link rel="stylesheet" type="text/css" href="/css/highlight.css"><link rel="stylesheet" type="text/css" href="/css/very-simple.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/font-awesome/4.5.0/css/font-awesome.min.css"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"></head><body><!-- include the sidebar--><!-- include ./includes/sidebar.jade--><!-- Blog title and subtitle--><header><div class="container header"><a id="logo" href="/." class="title">CS Blog</a><span class="subtitle">AI ML 自耕農</span><label id="toggle-menu" for="menu" onclick><i class="fa fa-bars"></i></label></div></header><!-- use checkbox hack for toggle nav-bar on small screens--><input id="menu" type="checkbox"><!-- Navigation Links--><nav id="nav"><div class="container"><a href="/" class="sidebar-nav-item active">Home</a><a href="/archives" class="sidebar-nav-item">Archives</a></div></nav><div id="header-margin-bar"></div><!-- gallery that comes before the header--><div class="wrapper"><div class="container post-header"><h1>GTX 1070</h1></div></div><div class="wrapper"><div class="container meta"><div class="post-time">2017-02-12</div><div class="post-categories"><a class="post-category-link" href="/categories/ML/">ML</a></div><div class="post-tags"><a class="post-tag-link" href="/tags/CUDA/">CUDA</a>/<a class="post-tag-link" href="/tags/Deep-Learning/">Deep Learning</a>/<a class="post-tag-link" href="/tags/NVIDIA/">NVIDIA</a>/<a class="post-tag-link" href="/tags/cuDNN/">cuDNN</a></div></div></div><article><div class="container post"><h3 id="NVIDIA-GTX-1070-參見"><a href="#NVIDIA-GTX-1070-參見" class="headerlink" title="NVIDIA GTX 1070 參見"></a>NVIDIA GTX 1070 參見</h3><p>經過兩次的Udacity DNN Projects後, 我受不了用CPU訓練了! 這實在是太慢了!<br>考量應該會長期使用GPU, AWS實在不怎麼便宜 (1hr=1USD @ Tokyo site), 加上local端訓練也比較方便, 就殺下去了!!<br><img src="/2017/02/12/GTX-1070/gtx1070.jpg" width="50%" height="50%"></p>
<hr>
<h3 id="安裝-CUDA-and-cuDNN"><a href="#安裝-CUDA-and-cuDNN" class="headerlink" title="安裝 CUDA and cuDNN"></a>安裝 CUDA and cuDNN</h3><p>大致上的安裝流程如下, 並不複雜, 更詳細可參考 <a href="http://blog.csdn.net/sb19931201/article/details/53648615" target="_blank" rel="external">link</a></p>
<ol>
<li><p>安裝 <a href="http://docs.nvidia.com/cuda/cuda-installation-guide-microsoft-windows/" target="_blank" rel="external">CUDA Drivers</a><br>上述聯結中有<a href="https://developer.nvidia.com/cuda-downloads" target="_blank" rel="external">下載路徑</a>, 然後照頁面一步步選擇 (Operating System, Version, Installer Type)<br>Installer Type如果網路不好建議選擇 exe local, 然後下載後執行安裝就對了<br>Windows 環境變量中 <strong>CUDA_PATH</strong> 是 <code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v8.0</code>, 但是仍須加上 <code>bin\</code> 和 <code>lib\x64\</code>, 記得加上.</p>
</li>
<li><p>安裝 <a href="https://developer.nvidia.com/cudnn" target="_blank" rel="external">cuDNN</a><br>要下載這個還要填一些登入資料, 需要再<a href="https://developer.nvidia.com/user" target="_blank" rel="external">Accelerated Computing Developer Program</a>註冊, 總之註冊後就可下載<br>解壓後會有一個資料夾 <code>cuda</code>, 裡面三個子資料夾 <code>bin, include, lib</code><br>將上述的檔案放到相對應的 CUDA Driver 的安裝路徑內, 預設是在 <code>C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v8.0</code></p>
</li>
<li><p>安裝 tensorflow-gpu<br>最簡單的一步<br><code>pip install tensorflow-gpu</code><br>然後即可測試, 如果有成功會有以下畫面, 注意 <strong>successfully</strong> 字有無出現</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</div><div class="line">I c:\tf_jenkins\home\workspace\release-win\device\gpu\os\windows\tensorflow\stream_executor\dso_loader.cc:<span class="number">128</span>] successfully opened CUDA library cublas64_80.dll locally</div><div class="line">I c:\tf_jenkins\home\workspace\release-win\device\gpu\os\windows\tensorflow\stream_executor\dso_loader.cc:<span class="number">128</span>] successfully opened CUDA library cudnn64_5.dll locally</div><div class="line">I c:\tf_jenkins\home\workspace\release-win\device\gpu\os\windows\tensorflow\stream_executor\dso_loader.cc:<span class="number">128</span>] successfully opened CUDA library cufft64_80.dll locally</div><div class="line">I c:\tf_jenkins\home\workspace\release-win\device\gpu\os\windows\tensorflow\stream_executor\dso_loader.cc:<span class="number">128</span>] successfully opened CUDA library nvcuda.dll locally</div><div class="line">I c:\tf_jenkins\home\workspace\release-win\device\gpu\os\windows\tensorflow\stream_executor\dso_loader.cc:<span class="number">128</span>] successfully opened CUDA library curand64_80.dll locally</div><div class="line">&gt;&gt;&gt;</div></pre></td></tr></table></figure>
</li>
</ol>
<hr>
<h3 id="測試-GTX-1070-強大能力"><a href="#測試-GTX-1070-強大能力" class="headerlink" title="測試 GTX 1070 強大能力"></a>測試 GTX 1070 強大能力</h3><p>使用兩個極端例子分別測試有無使用GPU速度上的差異</p>
<ol>
<li><p>Neural Art 的例子: <a href="http://arxiv.org/abs/1508.06576" target="_blank" rel="external">A Neural Algorithm of Artistic Style</a><br> 這個例子是所有的東西都可以 load 進 memory 中, 因此沒有任何 I/O, 直接比拚運算能力! 因此可以直接看出 GPU 和 CPU 的計算能力差異<br> 結果:<br><img src="/2017/02/12/GTX-1070/table1.png" alt="table1"></p>
<p>時間沒有很嚴格計算, 是看產生結果的時間稍微計算的, 但這效能已經很誇裝了, 60倍, 60倍, 60倍!<br>跑出來的圖:</p>
<ul>
<li><strong>Content Image</strong><br><img src="/2017/02/12/GTX-1070/family.bmp" width="50%" height="50%"></li>
<li><strong>Style Image</strong><br><img src="/2017/02/12/GTX-1070/guernica.jpg" width="50%" height="50%"></li>
<li><strong>Result Image</strong><br><img src="/2017/02/12/GTX-1070/final.png" width="50%" height="50%"></li>
</ul>
</li>
<li><p>不是所有的情況都能把 training data 和 model 都 load 進 memory 中, 所以勢必會有其他拖慢速度的環節, 其中最慢的就是 <em>I/O</em><br> 剛好 Udacity 的 <a href="https://bobondemon.github.io/2017/02/05/Driving-by-Learning-Your-Style/" target="_blank" rel="external">project 3</a> 就是每筆 training data 都需要去 load image 並且 on-the-fly 運算一堆 preprocessing.<br> 這個情況剛好是另一種可能的極端<br> 結果跑一個epoch所花的時間為<br><img src="/2017/02/12/GTX-1070/table2.png" alt="table2"><br>這種case看來只能加速到約 2倍. 沒辦法, 其他拖油瓶的動作佔太多比例了</p>
</li>
</ol>
<hr>
<h3 id="短結"><a href="#短結" class="headerlink" title="短結"></a>短結</h3><p>大部分的情況下, 提升的速度範圍會落在 <strong>2~60 倍</strong> 之間, 總之是值得的!</p>
<blockquote>
<p>就算不玩DNN, 電動也要把它打到物超所值!</p>
</blockquote>
</div><!-- comment system--><div class="container"><hr></div></article><footer id="footer"><div class="container"><div class="bar"><div class="social"><a href="/atom.xml" target="_blank"><i class="fa fa-rss"></i></a></div><div class="footer">© 2017 <a href="/" rel="nofollow">Bobon</a>. Powered by <a rel="nofollow" target="_blank" href="https://hexo.io">Hexo</a>. Theme <a target="_blank" href="https://github.com/lotabout/very-simple">very-simple</a>.</div></div></div></footer><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.css"><script src="//cdn.bootcss.com/jquery/2.0.3/jquery.min.js"></script><script src="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.pack.js"></script><script>$(document).ready(function() {
    $(".fancybox").fancybox();
});
</script></body></html>